<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Clases con Script</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            display: flex;
            gap: 20px;
        }
        
        .form-section {
            flex: 1;
            max-width: 600px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
        }
        
        textarea {
            height: 80px;
            resize: vertical;
        }
        
        button {
            background-color: #4285f4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        
        button:hover {
            background-color: #3b78e7;
        }
        
        .section-title {
            background-color: #3b78e7;
            padding: 10px;
            margin-top: 20px;
            border-radius: 4px;
            font-weight: bold;
            color: white;
        }
        
        #scriptOutput {
            width: 100%;
            height: 300px;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.4;
            padding: 15px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: auto;
            white-space: pre;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Generador de Script para Google Slides</h1>
    
    <div class="container">
        <div class="form-section">
            <form id="classForm">
                <div class="form-group">
                    <label for="tema_clase">Tema de la Clase:</label>
                    <input type="text" id="tema_clase" name="tema_clase" required>
                </div>
                
                <div class="section-title">1. Bienvenida</div>
                <div class="form-group">
                    <label for="introduccion_tema">Introducción al tema:</label>
                    <textarea id="introduccion_tema" name="introduccion_tema"></textarea>
                </div>
                
                <div class="section-title">2. Repaso y Puntos Clave</div>
                <div class="form-group">
                    <label for="pregunta_activacion_1">Pregunta de activación 1:</label>
                    <input type="text" id="pregunta_activacion_1" name="pregunta_activacion_1">
                </div>
                <div class="form-group">
                    <label for="pregunta_activacion_2">Pregunta de activación 2:</label>
                    <input type="text" id="pregunta_activacion_2" name="pregunta_activacion_2">
                </div>
                <div class="form-group">
                    <label for="ejemplo_personal">Ejemplo personal:</label>
                    <textarea id="ejemplo_personal" name="ejemplo_personal"></textarea>
                </div>
                
                <div class="section-title">3. Lo que Veremos Hoy</div>
                <div class="form-group">
                    <label for="estructura_clase">Estructura de la clase:</label>
                    <textarea id="estructura_clase" name="estructura_clase"></textarea>
                </div>

                <div class="section-title">4. La Historia de Hoy</div>
                <div class="form-group">
                    <label for="historia_principal">Historia principal:</label>
                    <textarea id="historia_principal" name="historia_principal"></textarea>
                </div>
                <div class="form-group">
                    <label for="pregunta_circular_1">Pregunta circular 1:</label>
                    <input type="text" id="pregunta_circular_1" name="pregunta_circular_1">
                </div>
                <div class="form-group">
                    <label for="pregunta_circular_2">Pregunta circular 2:</label>
                    <input type="text" id="pregunta_circular_2" name="pregunta_circular_2">
                </div>
                <div class="form-group">
                    <label for="pregunta_circular_3">Pregunta circular 3:</label>
                    <input type="text" id="pregunta_circular_3" name="pregunta_circular_3">
                </div>
                <div class="form-group">
                    <label for="actividad_interactiva_1">Actividad interactiva 1:</label>
                    <input type="text" id="actividad_interactiva_1" name="actividad_interactiva_1">
                </div>
                <div class="form-group">
                    <label for="actividad_interactiva_2">Actividad interactiva 2:</label>
                    <input type="text" id="actividad_interactiva_2" name="actividad_interactiva_2">
                </div>
                
                <div class="section-title">5. Lectura Corta</div>
                <div class="form-group">
                    <label for="texto_lectura">Texto de lectura:</label>
                    <textarea id="texto_lectura" name="texto_lectura"></textarea>
                </div>
                <div class="form-group">
                    <label for="pregunta_comprension_1">Pregunta de comprensión 1:</label>
                    <input type="text" id="pregunta_comprension_1" name="pregunta_comprension_1">
                </div>
                <div class="form-group">
                    <label for="pregunta_comprension_2">Pregunta de comprensión 2:</label>
                    <input type="text" id="pregunta_comprension_2" name="pregunta_comprension_2">
                </div>
                <div class="form-group">
                    <label for="pregunta_personalizada_1">Pregunta personalizada 1:</label>
                    <input type="text" id="pregunta_personalizada_1" name="pregunta_personalizada_1">
                </div>
                <div class="form-group">
                    <label for="pregunta_personalizada_2">Pregunta personalizada 2:</label>
                    <input type="text" id="pregunta_personalizada_2" name="pregunta_personalizada_2">
                </div>
                
                <div class="section-title">6. Resumen de la Sesión</div>
                <div class="form-group">
                    <label for="recapitulacion">Recapitulación:</label>
                    <textarea id="recapitulacion" name="recapitulacion"></textarea>
                </div>
                <div class="form-group">
                    <label for="retroalimentacion">Retroalimentación positiva:</label>
                    <input type="text" id="retroalimentacion" name="retroalimentacion">
                </div>
                <div class="form-group">
                    <label for="preguntas_finales">Preguntas finales:</label>
                    <input type="text" id="preguntas_finales" name="preguntas_finales">
                </div>
                
                <div class="section-title">7. Tarea y Ejercicios</div>
                <div class="form-group">
                    <label for="tarea">Tarea personalizada:</label>
                    <textarea id="tarea" name="tarea"></textarea>
                </div>
                <div class="form-group">
                    <label for="despedida">Despedida motivadora:</label>
                    <input type="text" id="despedida" name="despedida">
                </div>
                
                <div style="margin-top: 20px;">
                    <button type="button" onclick="cargarEjemplo()">Cargar Ejemplo</button>
                    <button type="button" onclick="generarScript()">Generar Script</button>
                    <button type="button" onclick="copiarScript()">Copiar Script</button>
                </div>
            </form>
        </div>
    </div>
    
    <h2>Script para Google Apps Script</h2>
    <pre id="scriptOutput">// El script se generará aquí</pre>

    <script>
        // Función para obtener datos del formulario y crear el objeto de reemplazos
        function getFormData() {
            return {
                "{{TEMA_CLASE}}": document.getElementById('tema_clase').value || "Título de la clase",
                "{{INTRODUCCION_TEMA}}": document.getElementById('introduccion_tema').value || "",
                "{{PREGUNTA_ACTIVACION_1}}": document.getElementById('pregunta_activacion_1').value || "",
                "{{PREGUNTA_ACTIVACION_2}}": document.getElementById('pregunta_activacion_2').value || "",
                "{{EJEMPLO_PERSONAL}}": document.getElementById('ejemplo_personal').value || "",
                "{{ESTRUCTURA_CLASE}}": document.getElementById('estructura_clase').value || "",
                "{{HISTORIA_PRINCIPAL}}": document.getElementById('historia_principal').value || "",
                "{{PREGUNTA_CIRCULAR_1}}": document.getElementById('pregunta_circular_1').value || "",
                "{{PREGUNTA_CIRCULAR_2}}": document.getElementById('pregunta_circular_2').value || "",
                "{{PREGUNTA_CIRCULAR_3}}": document.getElementById('pregunta_circular_3').value || "",
                "{{ACTIVIDAD_INTERACTIVA_1}}": document.getElementById('actividad_interactiva_1').value || "",
                "{{ACTIVIDAD_INTERACTIVA_2}}": document.getElementById('actividad_interactiva_2').value || "",
                "{{TEXTO_LECTURA}}": document.getElementById('texto_lectura').value || "",
                "{{PREGUNTA_COMPRENSION_1}}": document.getElementById('pregunta_comprension_1').value || "",
                "{{PREGUNTA_COMPRENSION_2}}": document.getElementById('pregunta_comprension_2').value || "",
                "{{PREGUNTA_PERSONALIZADA_1}}": document.getElementById('pregunta_personalizada_1').value || "",
                "{{PREGUNTA_PERSONALIZADA_2}}": document.getElementById('pregunta_personalizada_2').value || "",
                "{{RECAPITULACION}}": document.getElementById('recapitulacion').value || "",
                "{{RETROALIMENTACION}}": document.getElementById('retroalimentacion').value || "",
                "{{PREGUNTAS_FINALES}}": document.getElementById('preguntas_finales').value || "",
                "{{TAREA}}": document.getElementById('tarea').value || "",
                "{{DESPEDIDA}}": document.getElementById('despedida').value || ""
            };
        }

        // Función para generar el script
        function generarScript() {
            const formData = getFormData();
            const jsonString = JSON.stringify(formData, null, 2);
            
            const scriptTemplate = `// Script para reemplazar texto en una presentación de Google Slides

// Crear un botón en el menú
function onOpen() {
  SlidesApp.getUi()
    .createMenu('Reemplazar')
    .addItem('Ejecutar reemplazo', 'ejecutarReemplazo')
    .addToUi();
}

// Función que ejecuta el reemplazo directamente
function ejecutarReemplazo() {
  // CONFIGURA AQUÍ TUS REEMPLAZOS - ASEGÚRATE QUE COINCIDAN EXACTAMENTE
  var reemplazos = ${jsonString};
  
  // Obtener presentación
  var presentacion = SlidesApp.getActivePresentation();
  var diapositivas = presentacion.getSlides();
  var total = 0;
  
  // Para cada diapositiva, buscar y reemplazar texto
  for (var i = 0; i < diapositivas.length; i++) {
    var diapositiva = diapositivas[i];
    var elementos = diapositiva.getPageElements();
    
    for (var j = 0; j < elementos.length; j++) {
      var elemento = elementos[j];
      
      // Procesar formas (que contienen texto)
      if (elemento.getPageElementType() === SlidesApp.PageElementType.SHAPE) {
        var forma = elemento.asShape();
        if (forma.getText) {
          for (var marcador in reemplazos) {
            var textoNuevo = reemplazos[marcador];
            total += reemplazarEnElemento(forma, marcador, textoNuevo);
          }
        }
      }
      
      // Procesar tablas
      if (elemento.getPageElementType() === SlidesApp.PageElementType.TABLE) {
        var tabla = elemento.asTable();
        var filas = tabla.getNumRows();
        var columnas = tabla.getNumColumns();
        
        for (var r = 0; r < filas; r++) {
          for (var c = 0; c < columnas; c++) {
            var celda = tabla.getCell(r, c);
            for (var marcador in reemplazos) {
              var textoNuevo = reemplazos[marcador];
              total += reemplazarEnElemento(celda, marcador, textoNuevo);
            }
          }
        }
      }
    }
  }
  
  // Mostrar mensaje de resultado
  SlidesApp.getUi().alert("Se realizaron " + total + " reemplazos.");
}

// Función auxiliar para reemplazar texto en un elemento
function reemplazarEnElemento(elemento, marcador, textoNuevo) {
  var texto = elemento.getText();
  var contenido = texto.asString();
  
  if (contenido.indexOf(marcador) >= 0) {
    texto.replaceAllText(marcador, textoNuevo);
    return 1;
  }
  return 0;
}`;
            
            document.getElementById('scriptOutput').textContent = scriptTemplate;
        }
        
        // Función para copiar el script al portapapeles
        function copiarScript() {
            const scriptOutput = document.getElementById('scriptOutput');
            
            // Crear un elemento de texto temporal
            const el = document.createElement('textarea');
            el.value = scriptOutput.textContent;
            document.body.appendChild(el);
            
            // Seleccionar y copiar
            el.select();
            document.execCommand('copy');
            
            // Eliminar el elemento temporal
            document.body.removeChild(el);
            
            alert('¡Script copiado al portapapeles!');
        }
        
        // Función para cargar ejemplo
        function cargarEjemplo() {
            const ejemplo = {
                "tema_clase": "Hablar de Experiencias de Aprendizaje",
                "introduccion_tema": "Hoy vamos a hablar de experiencias de aprendizaje, cosas que empezaste a hacer, dejaste de hacer o volviste a intentar.",
                "pregunta_activacion_1": "¿Recuerdas alguna actividad que empezaste a hacer hace tiempo? Por ejemplo, tocar un instrumento o aprender un idioma.",
                "pregunta_activacion_2": "¿Hay algo que dejaste de hacer pero te gustaría volver a intentar?",
                "ejemplo_personal": "Yo, por ejemplo, empecé a aprender a cocinar durante la pandemia. Luego dejé de practicar, pero ahora quiero volver a intentarlo.",
                "estructura_clase": "Primero, vamos a hablar de tus experiencias. Luego, leeremos una historia corta sobre alguien que está aprendiendo algo nuevo. Finalmente, haremos un juego de roles.",
                "historia_principal": "María empezó a aprender a bailar salsa hace un mes. Al principio le costó mucho, pero no dejó de practicar. Hace una semana, volvió a tomar clases porque quiere mejorar.",
                "pregunta_circular_1": "¿Crees que a María le gusta bailar salsa?",
                "pregunta_circular_2": "¿Tú empezaste a aprender algo como María?",
                "pregunta_circular_3": "¿Qué harías tú si algo te cuesta mucho aprender?",
                "actividad_interactiva_1": "Ahora, imagina que tú eres María. ¿Qué me dirías sobre tu experiencia aprendiendo a bailar salsa?",
                "actividad_interactiva_2": "Si el estudiante se anima, puede inventar una historia similar sobre sí mismo o alguien más.",
                "texto_lectura": "Juan dejó de estudiar inglés hace dos años porque no tenía tiempo. Ahora quiere volver a aprender porque necesita el idioma para su trabajo. Empezó a tomar clases en línea y está muy motivado.",
                "pregunta_comprension_1": "¿Por qué Juan dejó de estudiar inglés?",
                "pregunta_comprension_2": "¿Qué está haciendo ahora para aprender?",
                "pregunta_personalizada_1": "¿Tú has dejado de aprender algo y luego volviste a intentarlo?",
                "pregunta_personalizada_2": "¿Qué cosas te gustaría empezar a aprender en el futuro?",
                "recapitulacion": "Hoy hablamos de experiencias de aprendizaje. Vimos cómo María empezó a bailar salsa y cómo Juan volvió a estudiar inglés. ¿Qué aprendiste hoy?",
                "retroalimentacion": "Me encantó cómo usaste las frases 'empecé a' y 'dejé de'. ¡Muy bien!",
                "preguntas_finales": "¿Tienes alguna duda o quieres repasar algo?",
                "tarea": "Para la próxima clase, piensa en algo que empezaste a hacer, dejaste de hacer o quieres volver a intentar. Escribe unas frases cortas y lo compartimos la próxima vez.",
                "despedida": "¡Gracias por tu esfuerzo hoy! Nos vemos en la próxima clase."
            };
            
            // Rellenar los campos del formulario
            for (const [id, valor] of Object.entries(ejemplo)) {
                if (document.getElementById(id)) {
                    document.getElementById(id).value = valor;
                }
            }
            
            // Generar el script con los datos de ejemplo
            generarScript();
        }
    </script>
</body>
</html>